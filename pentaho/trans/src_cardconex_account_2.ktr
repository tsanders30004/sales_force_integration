<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>src_cardconex_account_2</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>&#x2f;</directory>
    <parameters>
      <parameter>
        <name>dest_schema</name>
        <default_value>sales_force</default_value>
        <description/>
      </parameter>
      <parameter>
        <name>dest_table</name>
        <default_value>test_cardconex_account</default_value>
        <description/>
      </parameter>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2020&#x2f;01&#x2f;19 08&#x3a;42&#x3a;27.294</created_date>
    <modified_user>-</modified_user>
    <modified_date>2020&#x2f;01&#x2f;19 08&#x3a;42&#x3a;27.294</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA&#x3d;</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
    <notepad>
      <note>IMPORTANT&#xd;&#xa;---------&#xd;&#xa;If rows in fee_map are inserted, deleted, or updated, &#xd;&#xa;then the get_asset_data and subsequent steps will have to be edited.&#xd;&#xa;&#xd;&#xa;28 Jan 2020&#xd;&#xa;-----------&#xd;&#xa;There have been cases where the number of rows added to test_cardconex_account has been about half &#xd;&#xa;of the number of rows in the the merge_account_and_asset_data output stream.  &#xd;&#xa;No cause has been identified.  Keep an eye on this and if it happens again, some kind of fix &#xd;&#xa;will have to be defined and implemented.&#xd;&#xa;&#xd;&#xa;The original stg_cardconex_account table does not have a p2pe_transaction_fee.&#xd;&#xa;But I added one to test_cardconex_account.</note>
      <xloc>16</xloc>
      <yloc>0</yloc>
      <width>704</width>
      <heigth>208</heigth>
      <fontname>Courier New</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
  </notepads>
  <connection>
    <name>LOCALHOST &#x2f; Sales Force</name>
    <server>localhost</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>sales_force</database>
    <port>3306</port>
    <username>tsanders</username>
    <password>Encrypted 2be98afc86aa7f296aa14ac65ca97aecf</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>EXTRA_OPTION_MYSQL.defaultFetchSize</code><attribute>500</attribute></attribute>
      <attribute><code>EXTRA_OPTION_MYSQL.useCursorFetch</code><attribute>true</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>3306</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>Y</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>STREAM_RESULTS</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>sort_account_data</from>
      <to>merge_account_and_asset_data</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>sort_asset_data</from>
      <to>merge_account_and_asset_data</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>merge_account_and_asset_data</from>
      <to>select_values</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>get_asset_data_02</from>
      <to>group_by_acct_id</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>group_by_acct_id</from>
      <to>sort_asset_data</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>select_values</from>
      <to>set_null_fees_to_zero</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>set_null_fees_to_zero</from>
      <to>populate_test_cardconex_account</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>get_account_data</from>
      <to>calculations</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>calculations</from>
      <to>convert_date_format</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>convert_date_format</from>
      <to>sort_account_data</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>calculations</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>      <jsScript>        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>var closure_date &#x3d; &#x27;Use Identification_Number__c.Close Date&#x3f;&#x27;&#x3b;&#xd;&#xa;</jsScript_script>
      </jsScript>    </jsScripts>    <fields>      <field>        <name>closure_date</name>
        <rename>closure_date</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>    </fields>    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>192</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>convert_date_format</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>      <jsScript>        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>&#x2f;&#x2a; &#xd;&#xa;     converts date format.  Example&#x3a;  2020-01-14T20&#x3a;14&#x3a;54.000&#x2b;0000 becomes 20200114201454&#xd;&#xa;&#x2a;&#x2f;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;var dt_modified&#x3b;&#xd;&#xa;var dt_updated&#x3b;&#xd;&#xa;&#xd;&#xa;function reformat_date&#x28;d&#x29;&#x7b;&#xd;&#xa;   return d.substring&#x28;0, 4&#x29;&#xd;&#xa;            .concat&#x28;d.substr&#x28;5, 2&#x29;&#x29;&#xd;&#xa;            .concat&#x28;d.substr&#x28;8, 2&#x29;&#x29;&#xd;&#xa;            .concat&#x28;d.substr&#x28;11, 2&#x29;&#x29;&#xd;&#xa;            .concat&#x28;d.substr&#x28;14, 2&#x29;&#x29;&#xd;&#xa;            .concat&#x28;d.substr&#x28;17, 2&#x29;&#x29;&#x3b;&#xd;&#xa;&#x7d;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;dt_modified &#x3d; reformat_date&#x28;date_modified&#x29;&#x3b;&#xd;&#xa;dt_updated  &#x3d; reformat_date&#x28;date_updated&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;</jsScript_script>
      </jsScript>    </jsScripts>    <fields>      <field>        <name>dt_modified</name>
        <rename>date_modified</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>      <field>        <name>dt_updated</name>
        <rename>date_updated</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>Y</replace>
      </field>    </fields>    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>288</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>get_account_data</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>LOCALHOST &#x2f; Sales Force</connection>
    <sql>SELECT  &#xd;&#xa;    acct.Id                             AS acct_id&#xd;&#xa;   ,acct.Legacy_ID__c                   AS legacy_id&#xd;&#xa;   ,acct.Name                           AS acct_name&#xd;&#xa;   ,acct.AccountNumber                  AS accountnumber&#xd;&#xa;   ,acct.DBA_Name__c                    AS dba_name&#xd;&#xa;   ,acct.billingstreet                  AS dba_street&#xd;&#xa;   ,acct.billingcity                    AS dba_city&#xd;&#xa;   ,acct.billingstate                   AS dba_state&#xd;&#xa;   ,acct.billingpostalcode              AS dba_postal_code&#xd;&#xa;   ,acct.phone                          AS dba_phone&#xd;&#xa;   ,cont.contract_start_date__c         AS date_agreement_signed&#xd;&#xa;   ,acct.Sic                            AS sic&#xd;&#xa;   ,user.Name                           AS owner_name&#xd;&#xa;   ,user.FirstName                      AS owner_firstname&#xd;&#xa;   ,user.LastName                       AS owner_lastname&#xd;&#xa;   ,cont.contract_start_date__c         AS bluefin_contract_start_date&#xd;&#xa;   ,acct.Industry                       AS industry&#xd;&#xa;   ,acct.revenue_segment__c             AS segment&#xd;&#xa;   ,acct.ParentId                       AS parent_acct_id&#xd;&#xa;   ,CASE &#xd;&#xa;        WHEN cont.Hold_Billing__c &#x3d; 1 THEN &#x27;true&#x27;&#xd;&#xa;        WHEN cont.Hold_Billing__c &#x3d; 0 THEN &#x27;false&#x27;&#xd;&#xa;        ELSE NULL &#xd;&#xa;    END                                 AS hold_billing&#xd;&#xa;   ,cont.Billing_Hold_Release_Date__c   AS stop_billing&#xd;&#xa;   ,cont.Billing_Preference__c          AS billing_situation&#xd;&#xa;   ,cont.Billing_Frequency__c           AS billing_frequency&#xd;&#xa;   ,acct.LastModifiedDate               AS date_modified&#xd;&#xa;   ,acct.CreatedDate                    AS date_updated &#xd;&#xa;   ,acct.months_in_business__c          AS months_in_business&#xd;&#xa;  FROM account                          AS acct    &#xd;&#xa;  LEFT JOIN sales_contract__c           AS cont&#xd;&#xa;    ON acct.Id &#x3d; cont.AccountId__c &#xd;&#xa;  JOIN &#x60;user&#x60;                           AS &#x60;user&#x60;&#xd;&#xa;    ON acct.OwnerId &#x3d; user.Id  &#xd;&#xa; -- WHERE acct.Id &#x3d; &#x27;0013i00000EmHuvAAF&#x27; &#xd;&#xa;&#x3b;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>64</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>get_asset_data_02</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>LOCALHOST &#x2f; Sales Force</connection>
    <sql>SELECT &#xd;&#xa;     asst.accountid AS acct_id&#xd;&#xa;    ,asst.fee_name__c&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;ach_credit_fee&#x27;&#x29;                AS ach_credit_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;ach_monthly_fee&#x27;&#x29;               AS ach_monthly_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;ach_noc_fee&#x27;&#x29;                   AS ach_noc_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;ach_per_gw_trans_fee&#x27;&#x29;          AS ach_per_gw_trans_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;ach_return_error_fee&#x27;&#x29;          AS ach_return_error_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;ach_transaction_fee&#x27;&#x29;           AS ach_transaction_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;bfach_discount_rate&#x27;&#x29;           AS bfach_discount_rate&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;bluefin_gateway_discount_rate&#x27;&#x29; AS bluefin_gateway_discount_rate&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;file_transfer_monthly_fee&#x27;&#x29;     AS file_transfer_monthly_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;gateway_monthly_fee&#x27;&#x29;           AS gateway_monthly_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;group_tag_fee&#x27;&#x29;                 AS group_tag_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;gw_per_auth_decline_fee&#x27;&#x29;       AS gw_per_auth_decline_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;gw_per_credit_fee&#x27;&#x29;             AS gw_per_credit_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;gw_per_refund_fee&#x27;&#x29;             AS gw_per_refund_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;gw_per_sale_fee&#x27;&#x29;               AS gw_per_sale_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;gw_per_token_fee&#x27;&#x29;              AS gw_per_token_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;gw_reissued_fee&#x27;&#x29;               AS gw_reissued_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;misc_monthly_fees&#x27;&#x29;             AS misc_monthly_fees&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;one_time_key_injection_fees&#x27;&#x29;   AS one_time_key_injection_fees&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;p2pe_device_activated&#x27;&#x29;         AS p2pe_device_activated&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;p2pe_device_activating_fee&#x27;&#x29;    AS p2pe_device_activating_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;p2pe_device_stored_fee&#x27;&#x29;        AS p2pe_device_stored_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;p2pe_encryption_fee&#x27;&#x29;           AS p2pe_encryption_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;p2pe_monthly_flat_fee&#x27;&#x29;         AS p2pe_monthly_flat_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;p2pe_tokenization_fee&#x27;&#x29;         AS p2pe_tokenization_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;p2pe_transaction_fee&#x27;&#x29;          AS p2pe_transaction_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;pci_compliance_fee&#x27;&#x29;            AS pci_compliance_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;pci_non_compliance_fee&#x27;&#x29;        AS pci_non_compliance_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;pci_scans_monthly_fee&#x27;&#x29;         AS pci_scans_monthly_fee&#xd;&#xa;    ,COALESCE&#x28;fee_amount__c, 0&#x29; &#x2a; &#x28;fee&#x3d;&#x27;per_transaction_fee&#x27;&#x29;           AS per_transaction_fee&#xd;&#xa;  FROM asset          AS asst&#xd;&#xa;  LEFT JOIN fee_map   AS fm&#xd;&#xa;    ON asst.fee_name__c &#x3d; fm.fee_name&#xd;&#xa; ORDER BY accountid&#xd;&#xa;&#x3b;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>64</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>group_by_acct_id</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
      <all_rows>N</all_rows>
      <ignore_aggregate>N</ignore_aggregate>
      <field_ignore/>
      <directory>&#x25;&#x25;java.io.tmpdir&#x25;&#x25;</directory>
      <prefix>grp</prefix>
      <add_linenr>N</add_linenr>
      <linenr_fieldname/>
      <give_back_row>N</give_back_row>
      <group>
        <field>
          <name>acct_id</name>
        </field>
      </group>
      <fields>
        <field>
          <aggregate>ach_credit_fee</aggregate>
          <subject>ach_credit_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>ach_monthly_fee</aggregate>
          <subject>ach_monthly_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>ach_noc_fee</aggregate>
          <subject>ach_noc_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>ach_per_gw_trans_fee</aggregate>
          <subject>ach_per_gw_trans_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>ach_return_error_fee</aggregate>
          <subject>ach_return_error_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>ach_transaction_fee</aggregate>
          <subject>ach_transaction_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>bfach_discount_rate</aggregate>
          <subject>bfach_discount_rate</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>bluefin_gateway_discount_rate</aggregate>
          <subject>bluefin_gateway_discount_rate</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>file_transfer_monthly_fee</aggregate>
          <subject>file_transfer_monthly_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>gateway_monthly_fee</aggregate>
          <subject>gateway_monthly_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>group_tag_fee</aggregate>
          <subject>group_tag_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>gw_per_auth_decline_fee</aggregate>
          <subject>gw_per_auth_decline_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>gw_per_credit_fee</aggregate>
          <subject>gw_per_credit_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>gw_per_refund_fee</aggregate>
          <subject>gw_per_refund_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>gw_per_sale_fee</aggregate>
          <subject>gw_per_sale_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>gw_per_token_fee</aggregate>
          <subject>gw_per_token_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>gw_reissued_fee</aggregate>
          <subject>gw_reissued_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>misc_monthly_fees</aggregate>
          <subject>misc_monthly_fees</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>one_time_key_injection_fees</aggregate>
          <subject>one_time_key_injection_fees</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>p2pe_device_activated</aggregate>
          <subject>p2pe_device_activated</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>p2pe_device_activating_fee</aggregate>
          <subject>p2pe_device_activating_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>p2pe_device_stored_fee</aggregate>
          <subject>p2pe_device_stored_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>p2pe_encryption_fee</aggregate>
          <subject>p2pe_encryption_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>p2pe_monthly_flat_fee</aggregate>
          <subject>p2pe_monthly_flat_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>p2pe_tokenization_fee</aggregate>
          <subject>p2pe_tokenization_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>p2pe_transaction_fee</aggregate>
          <subject>p2pe_transaction_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>pci_compliance_fee</aggregate>
          <subject>pci_compliance_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>pci_non_compliance_fee</aggregate>
          <subject>pci_non_compliance_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>pci_scans_monthly_fee</aggregate>
          <subject>pci_scans_monthly_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>per_transaction_fee</aggregate>
          <subject>per_transaction_fee</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
      </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>192</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>merge_account_and_asset_data</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
<join_type>LEFT OUTER</join_type>
<step1>sort_account_data</step1>
<step2>sort_asset_data</step2>
    <keys_1>
      <key>acct_id</key>
    </keys_1>
    <keys_2>
      <key>acct_id</key>
    </keys_2>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>populate_test_cardconex_account</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>LOCALHOST &#x2f; Sales Force</connection>
    <schema>&#x24;&#x7b;dest_schema&#x7d;</schema>
    <table>&#x24;&#x7b;dest_table&#x7d;</table>
    <commit>1000</commit>
    <truncate>Y</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>accountnumber</column_name>
          <stream_name>accountnumber</stream_name>
        </field>
        <field>
          <column_name>acct_id</column_name>
          <stream_name>acct_id</stream_name>
        </field>
        <field>
          <column_name>acct_name</column_name>
          <stream_name>acct_name</stream_name>
        </field>
        <field>
          <column_name>ach_credit_fee</column_name>
          <stream_name>ach_credit_fee</stream_name>
        </field>
        <field>
          <column_name>ach_monthly_fee</column_name>
          <stream_name>ach_monthly_fee</stream_name>
        </field>
        <field>
          <column_name>ach_noc_fee</column_name>
          <stream_name>ach_noc_fee</stream_name>
        </field>
        <field>
          <column_name>ach_per_gw_trans_fee</column_name>
          <stream_name>ach_per_gw_trans_fee</stream_name>
        </field>
        <field>
          <column_name>ach_return_error_fee</column_name>
          <stream_name>ach_return_error_fee</stream_name>
        </field>
        <field>
          <column_name>ach_transaction_fee</column_name>
          <stream_name>ach_transaction_fee</stream_name>
        </field>
        <field>
          <column_name>bfach_discount_rate</column_name>
          <stream_name>bfach_discount_rate</stream_name>
        </field>
        <field>
          <column_name>billing_frequency</column_name>
          <stream_name>billing_frequency</stream_name>
        </field>
        <field>
          <column_name>billing_situation</column_name>
          <stream_name>billing_situation</stream_name>
        </field>
        <field>
          <column_name>bluefin_contract_start_date</column_name>
          <stream_name>bluefin_contract_start_date</stream_name>
        </field>
        <field>
          <column_name>bluefin_gateway_discount_rate</column_name>
          <stream_name>bluefin_gateway_discount_rate</stream_name>
        </field>
        <field>
          <column_name>closure_date</column_name>
          <stream_name>closure_date</stream_name>
        </field>
        <field>
          <column_name>date_agreement_signed</column_name>
          <stream_name>date_agreement_signed</stream_name>
        </field>
        <field>
          <column_name>date_modified</column_name>
          <stream_name>date_modified</stream_name>
        </field>
        <field>
          <column_name>date_updated</column_name>
          <stream_name>date_updated</stream_name>
        </field>
        <field>
          <column_name>dba_name</column_name>
          <stream_name>dba_name</stream_name>
        </field>
        <field>
          <column_name>dba_street</column_name>
          <stream_name>dba_street</stream_name>
        </field>
        <field>
          <column_name>dba_city</column_name>
          <stream_name>dba_city</stream_name>
        </field>
        <field>
          <column_name>dba_state</column_name>
          <stream_name>dba_state</stream_name>
        </field>
        <field>
          <column_name>dba_postal_code</column_name>
          <stream_name>dba_postal_code</stream_name>
        </field>
        <field>
          <column_name>dba_phone</column_name>
          <stream_name>dba_phone</stream_name>
        </field>
        <field>
          <column_name>file_transfer_monthly_fee</column_name>
          <stream_name>file_transfer_monthly_fee</stream_name>
        </field>
        <field>
          <column_name>gateway_monthly_fee</column_name>
          <stream_name>gateway_monthly_fee</stream_name>
        </field>
        <field>
          <column_name>group_tag_fee</column_name>
          <stream_name>group_tag_fee</stream_name>
        </field>
        <field>
          <column_name>gw_per_auth_decline_fee</column_name>
          <stream_name>gw_per_auth_decline_fee</stream_name>
        </field>
        <field>
          <column_name>gw_per_credit_fee</column_name>
          <stream_name>gw_per_credit_fee</stream_name>
        </field>
        <field>
          <column_name>gw_per_refund_fee</column_name>
          <stream_name>gw_per_refund_fee</stream_name>
        </field>
        <field>
          <column_name>gw_per_sale_fee</column_name>
          <stream_name>gw_per_sale_fee</stream_name>
        </field>
        <field>
          <column_name>gw_per_token_fee</column_name>
          <stream_name>gw_per_token_fee</stream_name>
        </field>
        <field>
          <column_name>gw_reissued_fee</column_name>
          <stream_name>gw_reissued_fee</stream_name>
        </field>
        <field>
          <column_name>hold_billing</column_name>
          <stream_name>hold_billing</stream_name>
        </field>
        <field>
          <column_name>industry</column_name>
          <stream_name>industry</stream_name>
        </field>
        <field>
          <column_name>legacy_id</column_name>
          <stream_name>legacy_id</stream_name>
        </field>
        <field>
          <column_name>misc_monthly_fees</column_name>
          <stream_name>misc_monthly_fees</stream_name>
        </field>
        <field>
          <column_name>months_in_business</column_name>
          <stream_name>months_in_business</stream_name>
        </field>
        <field>
          <column_name>one_time_key_injection_fees</column_name>
          <stream_name>one_time_key_injection_fees</stream_name>
        </field>
        <field>
          <column_name>owner_firstname</column_name>
          <stream_name>owner_firstname</stream_name>
        </field>
        <field>
          <column_name>owner_lastname</column_name>
          <stream_name>owner_lastname</stream_name>
        </field>
        <field>
          <column_name>owner_name</column_name>
          <stream_name>owner_name</stream_name>
        </field>
        <field>
          <column_name>p2pe_device_activated</column_name>
          <stream_name>p2pe_device_activated</stream_name>
        </field>
        <field>
          <column_name>p2pe_device_activating_fee</column_name>
          <stream_name>p2pe_device_activating_fee</stream_name>
        </field>
        <field>
          <column_name>p2pe_device_stored_fee</column_name>
          <stream_name>p2pe_device_stored_fee</stream_name>
        </field>
        <field>
          <column_name>p2pe_encryption_fee</column_name>
          <stream_name>p2pe_encryption_fee</stream_name>
        </field>
        <field>
          <column_name>p2pe_monthly_flat_fee</column_name>
          <stream_name>p2pe_monthly_flat_fee</stream_name>
        </field>
        <field>
          <column_name>p2pe_tokenization_fee</column_name>
          <stream_name>p2pe_tokenization_fee</stream_name>
        </field>
        <field>
          <column_name>p2pe_transaction_fee</column_name>
          <stream_name>p2pe_transaction_fee</stream_name>
        </field>
        <field>
          <column_name>parent_acct_id</column_name>
          <stream_name>parent_acct_id</stream_name>
        </field>
        <field>
          <column_name>pci_compliance_fee</column_name>
          <stream_name>pci_compliance_fee</stream_name>
        </field>
        <field>
          <column_name>pci_non_compliance_fee</column_name>
          <stream_name>pci_non_compliance_fee</stream_name>
        </field>
        <field>
          <column_name>pci_scans_monthly_fee</column_name>
          <stream_name>pci_scans_monthly_fee</stream_name>
        </field>
        <field>
          <column_name>per_transaction_fee</column_name>
          <stream_name>per_transaction_fee</stream_name>
        </field>
        <field>
          <column_name>segment</column_name>
          <stream_name>segment</stream_name>
        </field>
        <field>
          <column_name>sic</column_name>
          <stream_name>sic</stream_name>
        </field>
        <field>
          <column_name>stop_billing</column_name>
          <stream_name>stop_billing</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1024</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>select_values</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>      <field>        <name>accountnumber</name>
        <rename/>
      </field>      <field>        <name>acct_id</name>
        <rename/>
      </field>      <field>        <name>acct_name</name>
        <rename/>
      </field>      <field>        <name>ach_credit_fee</name>
        <rename/>
      </field>      <field>        <name>ach_monthly_fee</name>
        <rename/>
      </field>      <field>        <name>ach_noc_fee</name>
        <rename/>
      </field>      <field>        <name>ach_per_gw_trans_fee</name>
        <rename/>
      </field>      <field>        <name>ach_return_error_fee</name>
        <rename/>
      </field>      <field>        <name>ach_transaction_fee</name>
        <rename/>
      </field>      <field>        <name>bfach_discount_rate</name>
        <rename/>
      </field>      <field>        <name>billing_frequency</name>
        <rename/>
      </field>      <field>        <name>billing_situation</name>
        <rename/>
      </field>      <field>        <name>bluefin_contract_start_date</name>
        <rename/>
      </field>      <field>        <name>bluefin_gateway_discount_rate</name>
        <rename/>
      </field>      <field>        <name>closure_date</name>
        <rename/>
      </field>      <field>        <name>date_agreement_signed</name>
        <rename/>
      </field>      <field>        <name>date_modified</name>
        <rename/>
      </field>      <field>        <name>date_updated</name>
        <rename/>
      </field>      <field>        <name>dba_name</name>
        <rename/>
      </field>      <field>        <name>dba_street</name>
        <rename/>
      </field>      <field>        <name>dba_city</name>
        <rename/>
      </field>      <field>        <name>dba_state</name>
        <rename/>
      </field>      <field>        <name>dba_postal_code</name>
        <rename/>
      </field>      <field>        <name>dba_phone</name>
        <rename/>
      </field>      <field>        <name>file_transfer_monthly_fee</name>
        <rename/>
      </field>      <field>        <name>gateway_monthly_fee</name>
        <rename/>
      </field>      <field>        <name>group_tag_fee</name>
        <rename/>
      </field>      <field>        <name>gw_per_auth_decline_fee</name>
        <rename/>
      </field>      <field>        <name>gw_per_credit_fee</name>
        <rename/>
      </field>      <field>        <name>gw_per_refund_fee</name>
        <rename/>
      </field>      <field>        <name>gw_per_sale_fee</name>
        <rename/>
      </field>      <field>        <name>gw_per_token_fee</name>
        <rename/>
      </field>      <field>        <name>gw_reissued_fee</name>
        <rename/>
      </field>      <field>        <name>hold_billing</name>
        <rename/>
      </field>      <field>        <name>industry</name>
        <rename/>
      </field>      <field>        <name>legacy_id</name>
        <rename/>
      </field>      <field>        <name>misc_monthly_fees</name>
        <rename/>
      </field>      <field>        <name>months_in_business</name>
        <rename/>
      </field>      <field>        <name>one_time_key_injection_fees</name>
        <rename/>
      </field>      <field>        <name>owner_firstname</name>
        <rename/>
      </field>      <field>        <name>owner_lastname</name>
        <rename/>
      </field>      <field>        <name>owner_name</name>
        <rename/>
      </field>      <field>        <name>p2pe_device_activated</name>
        <rename/>
      </field>      <field>        <name>p2pe_device_activating_fee</name>
        <rename/>
      </field>      <field>        <name>p2pe_device_stored_fee</name>
        <rename/>
      </field>      <field>        <name>p2pe_encryption_fee</name>
        <rename/>
      </field>      <field>        <name>p2pe_monthly_flat_fee</name>
        <rename/>
      </field>      <field>        <name>p2pe_tokenization_fee</name>
        <rename/>
      </field>      <field>        <name>p2pe_transaction_fee</name>
        <rename/>
      </field>      <field>        <name>parent_acct_id</name>
        <rename/>
      </field>      <field>        <name>pci_compliance_fee</name>
        <rename/>
      </field>      <field>        <name>pci_non_compliance_fee</name>
        <rename/>
      </field>      <field>        <name>pci_scans_monthly_fee</name>
        <rename/>
      </field>      <field>        <name>per_transaction_fee</name>
        <rename/>
      </field>      <field>        <name>segment</name>
        <rename/>
      </field>      <field>        <name>sic</name>
        <rename/>
      </field>      <field>        <name>stop_billing</name>
        <rename/>
      </field>        <select_unspecified>N</select_unspecified>
    </fields>    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>720</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>set_null_fees_to_zero</name>
    <type>IfNull</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
      <replaceAllByValue/>
      <replaceAllMask/>
      <selectFields>Y</selectFields>
      <selectValuesType>N</selectValuesType>
      <setEmptyStringAll>N</setEmptyStringAll>
    <valuetypes>
      </valuetypes>
    <fields>
      <field>
        <name>ach_credit_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>ach_monthly_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>ach_noc_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>ach_per_gw_trans_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>ach_return_error_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>ach_transaction_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>bfach_discount_rate</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>bluefin_gateway_discount_rate</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>file_transfer_monthly_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>gateway_monthly_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>group_tag_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>gw_per_auth_decline_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>gw_per_credit_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>gw_per_refund_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>gw_per_sale_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>gw_per_token_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>gw_reissued_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>misc_monthly_fees</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>one_time_key_injection_fees</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>p2pe_device_activated</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>p2pe_device_activating_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>p2pe_device_stored_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>p2pe_encryption_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>p2pe_monthly_flat_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>p2pe_tokenization_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>p2pe_transaction_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>pci_compliance_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>pci_non_compliance_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>pci_scans_monthly_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      <field>
        <name>per_transaction_fee</name>
        <value>0</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
        </field>
      </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>848</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>sort_account_data</name>
    <type>SortRows</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
      <directory>&#x25;&#x25;java.io.tmpdir&#x25;&#x25;</directory>
      <prefix>out</prefix>
      <sort_size>1000000</sort_size>
      <free_memory/>
      <compress>N</compress>
      <compress_variable/>
      <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>acct_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>416</xloc>
      <yloc>256</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>sort_asset_data</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
      <directory>&#x25;&#x25;java.io.tmpdir&#x25;&#x25;</directory>
      <prefix>out</prefix>
      <sort_size>1000000</sort_size>
      <free_memory/>
      <compress>N</compress>
      <compress_variable/>
      <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>acct_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>368</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step>
    <name>populate_test_cardconex_account 2</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>LOCALHOST &#x2f; Sales Force</connection>
    <schema>&#x24;&#x7b;dest_schema&#x7d;</schema>
    <table>&#x24;&#x7b;dest_table&#x7d;</table>
    <commit>1000</commit>
    <truncate>Y</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>acct_id</column_name>
          <stream_name>acct_id</stream_name>
        </field>
        <field>
          <column_name>legacy_id</column_name>
          <stream_name>legacy_id</stream_name>
        </field>
        <field>
          <column_name>acct_name</column_name>
          <stream_name>acct_name</stream_name>
        </field>
        <field>
          <column_name>accountnumber</column_name>
          <stream_name>accountnumber</stream_name>
        </field>
        <field>
          <column_name>dba_name</column_name>
          <stream_name>dba_name</stream_name>
        </field>
        <field>
          <column_name>date_agreement_signed</column_name>
          <stream_name>date_agreement_signed</stream_name>
        </field>
        <field>
          <column_name>sic</column_name>
          <stream_name>sic</stream_name>
        </field>
        <field>
          <column_name>owner_name</column_name>
          <stream_name>owner_name</stream_name>
        </field>
        <field>
          <column_name>owner_firstname</column_name>
          <stream_name>owner_firstname</stream_name>
        </field>
        <field>
          <column_name>owner_lastname</column_name>
          <stream_name>owner_lastname</stream_name>
        </field>
        <field>
          <column_name>bluefin_contract_start_date</column_name>
          <stream_name>bluefin_contract_start_date</stream_name>
        </field>
        <field>
          <column_name>industry</column_name>
          <stream_name>industry</stream_name>
        </field>
        <field>
          <column_name>segment</column_name>
          <stream_name>segment</stream_name>
        </field>
        <field>
          <column_name>parent_acct_id</column_name>
          <stream_name>parent_acct_id</stream_name>
        </field>
        <field>
          <column_name>hold_billing</column_name>
          <stream_name>hold_billing</stream_name>
        </field>
        <field>
          <column_name>stop_billing</column_name>
          <stream_name>stop_billing</stream_name>
        </field>
        <field>
          <column_name>billing_situation</column_name>
          <stream_name>billing_situation</stream_name>
        </field>
        <field>
          <column_name>billing_frequency</column_name>
          <stream_name>billing_frequency</stream_name>
        </field>
        <field>
          <column_name>date_modified</column_name>
          <stream_name>date_modified</stream_name>
        </field>
        <field>
          <column_name>date_updated</column_name>
          <stream_name>date_updated</stream_name>
        </field>
        <field>
          <column_name>closure_date</column_name>
          <stream_name>closure_date</stream_name>
        </field>
        <field>
          <column_name>ach_credit_fee</column_name>
          <stream_name>ach_credit_fee</stream_name>
        </field>
        <field>
          <column_name>ach_monthly_fee</column_name>
          <stream_name>ach_monthly_fee</stream_name>
        </field>
        <field>
          <column_name>ach_noc_fee</column_name>
          <stream_name>ach_noc_fee</stream_name>
        </field>
        <field>
          <column_name>ach_per_gw_trans_fee</column_name>
          <stream_name>ach_per_gw_trans_fee</stream_name>
        </field>
        <field>
          <column_name>ach_return_error_fee</column_name>
          <stream_name>ach_return_error_fee</stream_name>
        </field>
        <field>
          <column_name>ach_transaction_fee</column_name>
          <stream_name>ach_transaction_fee</stream_name>
        </field>
        <field>
          <column_name>bfach_discount_rate</column_name>
          <stream_name>bfach_discount_rate</stream_name>
        </field>
        <field>
          <column_name>bluefin_gateway_discount_rate</column_name>
          <stream_name>bluefin_gateway_discount_rate</stream_name>
        </field>
        <field>
          <column_name>file_transfer_monthly_fee</column_name>
          <stream_name>file_transfer_monthly_fee</stream_name>
        </field>
        <field>
          <column_name>gateway_monthly_fee</column_name>
          <stream_name>gateway_monthly_fee</stream_name>
        </field>
        <field>
          <column_name>group_tag_fee</column_name>
          <stream_name>group_tag_fee</stream_name>
        </field>
        <field>
          <column_name>gw_per_auth_decline_fee</column_name>
          <stream_name>gw_per_auth_decline_fee</stream_name>
        </field>
        <field>
          <column_name>gw_per_credit_fee</column_name>
          <stream_name>gw_per_credit_fee</stream_name>
        </field>
        <field>
          <column_name>gw_per_refund_fee</column_name>
          <stream_name>gw_per_refund_fee</stream_name>
        </field>
        <field>
          <column_name>gw_per_sale_fee</column_name>
          <stream_name>gw_per_sale_fee</stream_name>
        </field>
        <field>
          <column_name>gw_per_token_fee</column_name>
          <stream_name>gw_per_token_fee</stream_name>
        </field>
        <field>
          <column_name>gw_reissued_fee</column_name>
          <stream_name>gw_reissued_fee</stream_name>
        </field>
        <field>
          <column_name>misc_monthly_fees</column_name>
          <stream_name>misc_monthly_fees</stream_name>
        </field>
        <field>
          <column_name>months_in_business</column_name>
          <stream_name>months_in_business__c</stream_name>
        </field>
        <field>
          <column_name>one_time_key_injection_fees</column_name>
          <stream_name>one_time_key_injection_fees</stream_name>
        </field>
        <field>
          <column_name>p2pe_device_activated</column_name>
          <stream_name>p2pe_device_activated</stream_name>
        </field>
        <field>
          <column_name>p2pe_device_activating_fee</column_name>
          <stream_name>p2pe_device_activating_fee</stream_name>
        </field>
        <field>
          <column_name>p2pe_device_stored_fee</column_name>
          <stream_name>p2pe_device_stored_fee</stream_name>
        </field>
        <field>
          <column_name>p2pe_encryption_fee</column_name>
          <stream_name>p2pe_encryption_fee</stream_name>
        </field>
        <field>
          <column_name>p2pe_monthly_flat_fee</column_name>
          <stream_name>p2pe_monthly_flat_fee</stream_name>
        </field>
        <field>
          <column_name>p2pe_tokenization_fee</column_name>
          <stream_name>p2pe_tokenization_fee</stream_name>
        </field>
        <field>
          <column_name>pci_compliance_fee</column_name>
          <stream_name>pci_compliance_fee</stream_name>
        </field>
        <field>
          <column_name>pci_non_compliance_fee</column_name>
          <stream_name>pci_non_compliance_fee</stream_name>
        </field>
        <field>
          <column_name>pci_scans_monthly_fee</column_name>
          <stream_name>pci_scans_monthly_fee</stream_name>
        </field>
        <field>
          <column_name>per_transaction_fee</column_name>
          <stream_name>per_transaction_fee</stream_name>
        </field>
    </fields>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1024</xloc>
      <yloc>336</yloc>
      <draw>Y</draw>
    </GUI>
    </step>

  <step_error_handling>
      <error>
        <source_step>convert_date_format</source_step>
        <target_step/>
        <is_enabled>Y</is_enabled>
        <nr_valuename/>
        <descriptions_valuename/>
        <fields_valuename/>
        <codes_valuename/>
        <max_errors/>
        <max_pct_errors/>
        <min_pct_rows/>
      </error>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>
